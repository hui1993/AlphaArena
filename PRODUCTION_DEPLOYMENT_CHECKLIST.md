# Alpha Arena V3.5 生产环境部署检查清单

**版本**: V3.5 (2分钟超短线 + 浮盈滚仓)
**最后更新**: 2025-10-25
**部署前必读**: 本清单确保系统安全、稳定地部署到生产环境

---

## ✅ 1. 功能测试验证

### 1.1 浮盈滚仓功能
- [ ] 运行 `python3 test_production_readiness.py`
- [ ] 确认所有10个测试通过 (10/10)
- [ ] 验证滚仓阈值: 1.5%
- [ ] 验证加仓比例: 50%
- [ ] 验证最大滚仓次数: 2次
- [ ] 验证时间间隔: 3分钟

**验证命令**:
```bash
python3 test_production_readiness.py
# 预期输出: 🎉 所有测试通过! 系统已准备好用于生产环境!
```

### 1.2 移动止盈止损功能
- [ ] 多头盈利移动止损测试通过
- [ ] 空头盈利移动止损测试通过
- [ ] 基于ATR的动态止损测试通过
- [ ] 滚仓后动态止盈提升测试通过

### 1.3 ZenMux API集成
- [ ] 运行 `python3 test_zenmux_api.py`
- [ ] API连接成功
- [ ] Token使用正常
- [ ] AI决策返回正常

**验证命令**:
```bash
python3 test_zenmux_api.py
# 预期输出: ✅ API 连接成功!
```

---

## ⚙️ 2. 环境配置检查

### 2.1 API密钥配置
- [ ] `.env` 文件存在
- [ ] `BINANCE_API_KEY` 已设置且有效
- [ ] `BINANCE_API_SECRET` 已设置且有效
- [ ] `DEEPSEEK_API_KEY` 已设置 (ZenMux)
- [ ] API密钥权限正确:
  - [ ] 启用期货交易
  - [ ] 启用读取权限
  - [ ] 未启用提现权限 (安全)

**验证命令**:
```bash
grep -E "BINANCE_API_KEY|DEEPSEEK_API_KEY" .env | wc -l
# 预期输出: 2 (两个密钥都配置)
```

### 2.2 交易参数配置
- [ ] `TRADING_INTERVAL_SECONDS=120` (2分钟)
- [ ] `DEFAULT_LEVERAGE=30` (30倍杠杆)
- [ ] `INITIAL_CAPITAL` 设置合理金额
- [ ] `MAX_POSITION_PCT=10` (10%持仓限制)
- [ ] `TRADING_SYMBOLS` 包含目标交易对
- [ ] `BINANCE_TESTNET=false` (生产环境)

**配置示例**:
```env
TRADING_INTERVAL_SECONDS=120
DEFAULT_LEVERAGE=30
INITIAL_CAPITAL=20
MAX_POSITION_PCT=10
TRADING_SYMBOLS=ETHUSDT,SOLUSDT,BNBUSDT
BINANCE_TESTNET=false
```

---

## 🔒 3. 安全检查

### 3.1 Binance账户安全
- [ ] API密钥IP白名单已设置
- [ ] 密钥权限仅限期货交易+读取
- [ ] 未授予提现权限
- [ ] 账户余额在可接受损失范围内
- [ ] 设置了价格警报 (Binance App)

### 3.2 风险参数确认
- [ ] 理解30-80倍杠杆的清算风险
- [ ] 理解1.5%滚仓阈值可能频繁触发
- [ ] 理解2分钟超短线需密切监控
- [ ] 准备好应急止损措施

**清算风险计算**:
- 30倍杠杆: 反向波动3.33%即清算
- 80倍杠杆: 反向波动1.25%即清算

### 3.3 代码安全
- [ ] 未在代码中硬编码密钥
- [ ] `.env` 文件已添加到 `.gitignore`
- [ ] 所有密钥信息都在环境变量中
- [ ] 日志文件不包含敏感信息

---

## 🧪 4. 测试网验证 (可选但推荐)

### 4.1 测试网部署
- [ ] 设置 `BINANCE_TESTNET=true`
- [ ] 获取测试网API密钥
- [ ] 测试网充值完成
- [ ] 运行至少1小时测试
- [ ] 验证滚仓功能正常触发
- [ ] 验证止盈止损正常执行

**测试网步骤**:
```bash
# 1. 修改.env
BINANCE_TESTNET=true
BINANCE_API_KEY=testnet_key
BINANCE_API_SECRET=testnet_secret

# 2. 获取测试网密钥
# 访问: https://testnet.binancefuture.com

# 3. 启动bot
python3 alpha_arena_bot.py

# 4. 监控至少1小时
tail -f logs/alpha_arena_*.log | grep ROLL

# 5. 验证成功后切回主网
BINANCE_TESTNET=false
```

---

## 📊 5. 监控系统准备

### 5.1 日志系统
- [ ] `logs/` 目录存在且可写
- [ ] 日志轮转正常工作
- [ ] 能够实时查看日志
- [ ] 滚仓日志 `[ROLL-CHECK]` 正常输出

**监控命令**:
```bash
# 实时查看所有日志
tail -f logs/alpha_arena_$(date +%Y%m%d).log

# 仅查看滚仓相关日志
tail -f logs/alpha_arena_*.log | grep ROLL

# 使用监控脚本
./monitor_rolling.sh
```

### 5.2 性能追踪
- [ ] `performance_data.json` 可读写
- [ ] `ai_decisions.json` 可读写
- [ ] Dashboard可访问 (如使用)
- [ ] 能够查看实时账户状态

### 5.3 告警系统
- [ ] Binance App价格警报已设置
- [ ] 清算价格警报已设置
- [ ] (可选) Telegram通知已配置
- [ ] 手机保持在身边

---

## 🚀 6. 部署执行

### 6.1 部署前最后检查
- [ ] 所有上述检查项已完成
- [ ] 测试套件全部通过
- [ ] 账户余额已确认
- [ ] 监控工具已准备好

### 6.2 启动系统
```bash
# 方式1: 直接启动 (前台运行)
python3 alpha_arena_bot.py

# 方式2: 使用screen后台运行
./manage.sh screen
# 或
screen -S alpha_arena
python3 alpha_arena_bot.py
# 按 Ctrl+A+D 分离

# 方式3: 使用管理脚本
./manage.sh start
```

### 6.3 启动后验证
- [ ] Bot进程正在运行
- [ ] 日志正常输出
- [ ] 滚仓管理器已启动
- [ ] 账户余额正确显示
- [ ] 第一轮交易循环完成

**验证命令**:
```bash
# 检查进程
ps aux | grep alpha_arena_bot.py

# 检查最新日志
tail -n 50 logs/alpha_arena_*.log

# 运行监控脚本
./monitor_rolling.sh

# 预期看到:
# [OK] 浮盈滚仓管理器已启动 (盈利>1.5%触发, 最多滚2次)
# [ROLL-CHECK] 检查 SOLUSDT 滚仓条件...
```

---

## 🔍 7. 运行监控

### 7.1 前5分钟密切监控
- [ ] 每30秒检查一次日志
- [ ] 确认AI决策正常
- [ ] 确认滚仓检查正常
- [ ] 无异常错误

### 7.2 前30分钟常规监控
- [ ] 每5分钟运行 `./monitor_rolling.sh`
- [ ] 检查持仓状态
- [ ] 检查盈亏情况
- [ ] 观察是否有滚仓触发

### 7.3 持续监控
- [ ] 每10-15分钟检查一次
- [ ] 关注清算距离
- [ ] 关注滚仓触发情况
- [ ] 记录异常行为

**监控清单**:
```
□ 账户余额正常
□ 持仓数量合理
□ 盈亏在预期范围
□ 清算距离 > 5%
□ AI决策合理
□ 滚仓逻辑正常
□ 无系统错误
```

---

## ⚠️ 8. 应急响应

### 8.1 立即停止条件
以下任何情况发生,立即停止bot:
- [ ] 清算距离 < 2%
- [ ] 账户浮亏 > 20%
- [ ] 系统出现频繁错误
- [ ] API连接持续失败
- [ ] 异常的大额订单

**紧急停止命令**:
```bash
# 方式1: 找到PID并kill
ps aux | grep alpha_arena
kill -9 <PID>

# 方式2: 使用管理脚本
./manage.sh stop

# 方式3: 如果在前台运行
Ctrl+C

# 确认停止
ps aux | grep alpha_arena
```

### 8.2 问题排查流程
1. **检查日志**: `tail -n 100 logs/alpha_arena_*.log`
2. **检查持仓**: 登录Binance查看实际持仓
3. **检查账户**: 确认余额和保证金
4. **检查API**: 运行 `python3 test_zenmux_api.py`
5. **检查配置**: 确认 `.env` 文件配置

### 8.3 常见问题
| 问题 | 可能原因 | 解决方案 |
|------|---------|----------|
| 滚仓不触发 | 盈利未达1.5% | 等待,或调整阈值 |
| API错误 | 密钥无效/过期 | 重新生成密钥 |
| 清算警告 | 杠杆过高 | 降低杠杆或减仓 |
| 订单失败 | 余额不足 | 增加保证金 |
| 连接失败 | 网络问题 | 检查网络,重启 |

---

## 📋 9. 性能基准

### 9.1 预期表现
- **交易周期**: 120秒 (2分钟)
- **滚仓阈值**: 1.5%盈利
- **滚仓频率**: 视市场波动,估计1-5次/天
- **最大持仓**: 初始仓位 × 2.25倍 (2次滚仓)

### 9.2 关键指标监控
- **胜率**: > 50% 为良好
- **最大回撤**: < 20% 可接受
- **平均持仓时间**: 5-30分钟
- **滚仓成功率**: 记录触发vs成功比例

---

## 📞 10. 支持资源

### 10.1 文档
- `README.md` - 项目概览
- `UPGRADE_V3.5_SUMMARY.md` - V3.5升级详情
- `V3.5_FINAL_STATUS.md` - 最终状态报告
- `CHANGELOG_V3.5.md` - 详细更新日志

### 10.2 测试工具
- `test_production_readiness.py` - 生产就绪性测试
- `test_zenmux_api.py` - API连接测试
- `test_rolling_live.py` - 滚仓逻辑测试
- `monitor_rolling.sh` - 实时监控脚本

### 10.3 管理工具
- `manage.sh start` - 启动bot
- `manage.sh stop` - 停止bot
- `manage.sh logs` - 查看日志
- `manage.sh status` - 查看状态
- `./monitor_rolling.sh` - 滚仓监控

---

## ✅ 11. 最终确认

部署前,请确认以下声明:

- [ ] 我已完整阅读本检查清单
- [ ] 我理解30-80倍杠杆的极高风险
- [ ] 我理解可能损失全部资金
- [ ] 我的初始资金在可承受损失范围内 (≤ 20 USDT推荐)
- [ ] 我已设置好监控和警报系统
- [ ] 我已准备好密切监控系统运行
- [ ] 我知道如何紧急停止系统
- [ ] 我已在测试网验证过功能 (或自愿跳过)
- [ ] 所有测试套件已通过 (10/10)
- [ ] 我已阅读并理解风险提示

**风险声明**:
> ⚠️ 本系统使用极高杠杆进行超短线交易,存在极高风险。
> 即使所有测试通过,仍可能因市场剧烈波动导致重大损失。
> 请仅使用可承受全部损失的资金,并保持密切监控。

---

## 🎯 12. 部署后首个小时检查清单

### 前10分钟 (每2分钟检查)
- [ ] 02分钟: 确认第一轮交易完成
- [ ] 04分钟: 确认AI决策正常
- [ ] 06分钟: 确认滚仓检查正常
- [ ] 08分钟: 确认无错误日志
- [ ] 10分钟: 检查账户状态

### 10-30分钟 (每5分钟检查)
- [ ] 15分钟: 运行 `./monitor_rolling.sh`
- [ ] 20分钟: 检查持仓盈亏
- [ ] 25分钟: 检查清算距离
- [ ] 30分钟: 完整状态审查

### 30-60分钟 (每10分钟检查)
- [ ] 40分钟: 常规监控
- [ ] 50分钟: 常规监控
- [ ] 60分钟: 第一小时总结

**第一小时总结表**:
```
□ 交易轮数: ___ 轮 (预期~30轮)
□ AI决策数: ___ 次
□ 开仓次数: ___ 次
□ 滚仓次数: ___ 次
□ 当前盈亏: ____%
□ 最大持仓: ___ 个
□ 清算距离: ____%
□ 系统错误: ___ 次
□ 总体评估: □正常 □警告 □异常
```

---

## 📅 13. 定期维护计划

### 每日
- [ ] 查看当日交易总结
- [ ] 检查滚仓触发记录
- [ ] 检查账户盈亏
- [ ] 备份日志文件

### 每周
- [ ] 分析胜率和回撤
- [ ] 评估滚仓策略效果
- [ ] 考虑参数优化
- [ ] 更新API密钥 (如需要)

### 每月
- [ ] 全面性能评估
- [ ] 策略回测分析
- [ ] 考虑版本升级
- [ ] 安全审计

---

**部署日期**: _____________
**部署人员**: _____________
**初始资金**: _____________
**部署签名**: _____________

---

**V3.5 部署检查清单 - 确保生产环境安全稳定运行** 🚀
